{% extends "base.html" %}

{% block title %}Enroll {{ student.full_name }} - LMS{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1 class="page-title">
            <i class="fas fa-user-plus"></i>
            Enroll Student
        </h1>
    </div>
</div>

<div class="enrollment-container">
    <!-- Student Information Card -->
    <div class="student-info-card">
        <div class="student-avatar">
            {% if student.profile_picture %}
            <img src="{{ url_for('static', filename=student.profile_picture) }}" alt="Student Photo">
            {% else %}
            <i class="fas fa-user-graduate"></i>
            {% endif %}
        </div>
        <div class="student-details">
            <h3>{{ student.full_name }}</h3>
            <p><strong>Student ID:</strong> {{ student.student_id }}</p>
            <p><strong>Grade:</strong> {{ student.grade or 'Not specified' }}</p>
            <p><strong>Department:</strong> {{ student.department.name if student.department else 'Not assigned' }}</p>
        </div>
    </div>

    {% if tutors|length == 0 %}
    <div class="empty-state">
        <i class="fas fa-chalkboard-teacher"></i>
        <h3>No Tutors Available</h3>
        <p>Please contact an administrator to add tutors before enrolling students.</p>
        <a href="{{ url_for('students') }}" class="btn btn-primary">
            <i class="fas fa-arrow-left"></i> Back to Students
        </a>
    </div>
    {% else %}
    
    <form method="POST" id="enrollmentForm">
        <!-- Class Type Selection -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-graduation-cap"></i>
                    Enrollment Type
                </h3>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label class="form-label required">Class Type</label>
                    <select name="class_type" id="classType" class="form-control" required>
                        <option value="regular">Regular Classes</option>
                        <option value="trial">Trial Class (3 sessions)</option>
                        <option value="demo">Demo Class (1 session)</option>
                        <option value="batch">Batch Classes</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Subject Selection with Enhanced Tutor Filtering -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-books"></i>
                    Select Subjects & Tutors
                </h3>
                <button type="button" class="btn btn-sm btn-primary" onclick="addSubject()">
                    <i class="fas fa-plus"></i> Add Subject
                </button>
            </div>
            <div class="card-body">
                <div id="subjectsContainer">
                    <!-- Dynamic subject entries will be added here -->
                </div>
                <p class="text-muted mt-2">
                    <small><i class="fas fa-info-circle"></i> 
                    You can add multiple subjects. Each subject will have its own tutor and schedule.</small>
                </p>
            </div>
        </div>

        <!-- Schedule Configuration -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-calendar-alt"></i>
                    Schedule Configuration
                </h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label required">Start Date</label>
                            <input type="date" name="start_date" class="form-control" required 
                                   min="{{ (moment().format('YYYY-MM-DD')) if moment else '' }}"
                                   value="{{ (moment().add(1, 'days').format('YYYY-MM-DD')) if moment else '' }}">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="form-label">End Date (Optional)</label>
                            <input type="date" name="end_date" class="form-control">
                            <small class="form-text text-muted">Leave empty for ongoing classes</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Meeting Configuration -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-video"></i>
                    Meeting Configuration
                </h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">Video Platform</label>
                            <select name="video_platform" class="form-control" onchange="updateVideoOptions()">
                                <option value="zoom">Zoom</option>
                                <option value="teams">Microsoft Teams</option>
                                <option value="meet">Google Meet</option>
                                <option value="custom">Custom Link</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">Meeting ID</label>
                            <input type="text" name="meeting_id" class="form-control" 
                                   placeholder="Meeting ID or Room Name">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="form-label">Meeting Password</label>
                            <input type="text" name="meeting_password" class="form-control" 
                                   placeholder="Meeting password">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Form Actions -->
        <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-check"></i>
                Complete Enrollment
            </button>
            <a href="{{ url_for('view_student', id=student.id) }}" class="btn btn-secondary">
                Cancel
            </a>
        </div>
    </form>
    {% endif %}
</div>

<!-- Enhanced Subject Entry Template with Filtering -->
<template id="subjectTemplate">
    <div class="subject-entry" data-subject-index="">
        <div class="subject-header">
            <h5 class="subject-title">
                <i class="fas fa-book"></i>
                <span class="subject-name">New Subject</span>
            </h5>
            <button type="button" class="btn btn-sm btn-danger" onclick="removeSubject(this)">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="subject-content">
            <!-- Subject Selection Row -->
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label required">Subject</label>
                        <select name="subjects[].name" class="form-control subject-select" required onchange="updateSubjectTitle(this); filterTutors(this)">
                            <option value="">Select Subject</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="Physics">Physics</option>
                            <option value="Chemistry">Chemistry</option>
                            <option value="Biology">Biology</option>
                            <option value="English">English</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Economics">Economics</option>
                            <option value="Accountancy">Accountancy</option>
                            <option value="Business Studies">Business Studies</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Political Science">Political Science</option>
                            <option value="Psychology">Psychology</option>
                            <option value="Sociology">Sociology</option>
                            <option value="Hindi">Hindi</option>
                            <option value="French">French</option>
                            <option value="German">German</option>
                            <option value="Spanish">Spanish</option>
                        </select>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label">Grade Level</label>
                        <select name="subjects[].grade" class="form-control grade-select" onchange="filterTutors(this)">
                            <option value="">Any Grade</option>
                            <option value="Grade 1">Grade 1</option>
                            <option value="Grade 2">Grade 2</option>
                            <option value="Grade 3">Grade 3</option>
                            <option value="Grade 4">Grade 4</option>
                            <option value="Grade 5">Grade 5</option>
                            <option value="Grade 6">Grade 6</option>
                            <option value="Grade 7">Grade 7</option>
                            <option value="Grade 8">Grade 8</option>
                            <option value="Grade 9">Grade 9</option>
                            <option value="Grade 10">Grade 10</option>
                            <option value="Grade 11">Grade 11</option>
                            <option value="Grade 12">Grade 12</option>
                            <option value="Undergraduate">Undergraduate</option>
                            <option value="Postgraduate">Postgraduate</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Tutor Search and Filter -->
            <div class="tutor-search-section">
                <label class="form-label required">Select Tutor</label>
                
                <!-- Search Bar -->
                <div class="search-filters-row">
                    <div class="search-input-container">
                        <input type="text" class="form-control tutor-search" placeholder="Search tutors by name, qualification, or experience..." onkeyup="searchTutors(this)">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    
                    <div class="filter-buttons">
                        <select class="form-control filter-select" onchange="filterTutors(this)">
                            <option value="">All Rates</option>
                            <option value="0-500">₹0 - ₹500/hr</option>
                            <option value="500-1000">₹500 - ₹1000/hr</option>
                            <option value="1000-2000">₹1000 - ₹2000/hr</option>
                            <option value="2000+">₹2000+/hr</option>
                        </select>
                        
                        <select class="form-control filter-select" onchange="filterTutors(this)">
                            <option value="">All Experience</option>
                            <option value="0-2">0-2 years</option>
                            <option value="3-5">3-5 years</option>
                            <option value="5+">5+ years</option>
                        </select>
                        
                        <button type="button" class="btn btn-outline-secondary" onclick="clearFilters(this)">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                </div>

                <!-- Tutors Grid -->
                <div class="tutors-grid">
                    {% for tutor in tutors %}
                    <div class="tutor-card" 
                         data-tutor-id="{{ tutor.id }}"
                         data-tutor-name="{{ tutor.full_name|lower }}"
                         data-tutor-subjects="{% if tutor.tutor_profile %}{{ tutor.tutor_profile.get_specialization()|join(',')|lower }}{% endif %}"
                         data-tutor-grades="{% if tutor.tutor_profile %}{{ tutor.tutor_profile.get_preferred_grades()|join(',')|lower }}{% endif %}"
                         data-tutor-rate="{% if tutor.tutor_profile %}{{ tutor.tutor_profile.hourly_rate or 0 }}{% else %}0{% endif %}"
                         data-tutor-experience="{% if tutor.tutor_profile %}{{ tutor.tutor_profile.experience_years or 0 }}{% else %}0{% endif %}"
                         onclick="selectTutor(this)">
                        
                        <div class="tutor-header">
                            <div class="tutor-avatar">
                                {% if tutor.profile_picture %}
                                <img src="{{ url_for('static', filename=tutor.profile_picture) }}" alt="Tutor">
                                {% else %}
                                <i class="fas fa-chalkboard-teacher"></i>
                                {% endif %}
                            </div>
                            <div class="tutor-info">
                                <h5>{{ tutor.full_name }}</h5>
                                {% if tutor.tutor_profile %}
                                <p class="qualification">{{ tutor.tutor_profile.qualification or 'No qualification listed' }}</p>
                                {% endif %}
                            </div>
                            <div class="selection-indicator">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        
                        <div class="tutor-details">
                            <div class="detail-row">
                                <span class="label">Experience:</span>
                                <span class="value">{% if tutor.tutor_profile %}{{ tutor.tutor_profile.experience_years or 0 }} years{% else %}0 years{% endif %}</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">Rate:</span>
                                <span class="value">₹{% if tutor.tutor_profile %}{{ tutor.tutor_profile.hourly_rate or 0 }}{% else %}0{% endif %}/hour</span>
                            </div>
                            {% if tutor.tutor_profile and tutor.tutor_profile.average_rating %}
                            <div class="detail-row">
                                <span class="label">Rating:</span>
                                <span class="value rating">
                                    {% for i in range(5) %}
                                    <i class="fas fa-star {% if i < tutor.tutor_profile.average_rating %}active{% endif %}"></i>
                                    {% endfor %}
                                    {{ "%.1f"|format(tutor.tutor_profile.average_rating) }}
                                </span>
                            </div>
                            {% endif %}
                        </div>
                        
                        {% if tutor.tutor_profile %}
                        <div class="specialization-tags">
                            {% for subject in tutor.tutor_profile.get_specialization()[:3] %}
                            <span class="subject-tag">{{ subject }}</span>
                            {% endfor %}
                            {% if tutor.tutor_profile.get_specialization()|length > 3 %}
                            <span class="subject-tag more">+{{ tutor.tutor_profile.get_specialization()|length - 3 }}</span>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>

                <!-- Hidden input for selected tutor -->
                <input type="hidden" name="subjects[].tutor_id" class="selected-tutor-input" required>
                <div class="no-tutors-message" style="display: none;">
                    <p class="text-muted text-center py-4">
                        <i class="fas fa-info-circle"></i>
                        No tutors found matching your criteria
                    </p>
                </div>
            </div>
            
            <!-- Session Configuration -->
            <div class="row mt-3">
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label required">Sessions per Week</label>
                        <select name="subjects[].sessions_per_week" class="form-control" required>
                            <option value="1">1 session/week</option>
                            <option value="2" selected>2 sessions/week</option>
                            <option value="3">3 sessions/week</option>
                            <option value="4">4 sessions/week</option>
                            <option value="5">5 sessions/week</option>
                        </select>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="form-label required">Session Duration</label>
                        <select name="subjects[].session_duration" class="form-control" required>
                            <option value="30">30 minutes</option>
                            <option value="45">45 minutes</option>
                            <option value="60" selected>1 hour</option>
                            <option value="90">1.5 hours</option>
                            <option value="120">2 hours</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Schedule Selection -->
            <div class="schedule-selection">
                <label class="form-label">Preferred Days & Times</label>
                <div class="days-grid">
                    {% set days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
                    {% set day_names = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
                    
                    {% for day, day_name in zip(days, day_names) %}
                    <div class="day-time-slot">
                        <label class="day-checkbox">
                            <input type="checkbox" name="subjects[].schedule_days" value="{{ day }}">
                            <span class="day-name">{{ day_name }}</span>
                        </label>
                        <select name="subjects[].schedule_times_{{ day }}" class="form-control time-select" disabled>
                            <option value="">Select Time</option>
                            {% for hour in range(8, 21) %}
                            <option value="{{ '%02d:00'|format(hour) }}">{{ '%02d:00'|format(hour) }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</template>

<script>
let subjectCount = 0;

// Initialize with one subject
document.addEventListener('DOMContentLoaded', function() {
    const tutorsCount = "{{ tutors|length|tojson }}";
    if (parseInt(tutorsCount) > 0) {
        addSubject();
    }
});

function addSubject() {
    const container = document.getElementById('subjectsContainer');
    const template = document.getElementById('subjectTemplate');
    const clone = template.content.cloneNode(true);
    
    // Update indices
    const subjectEntry = clone.querySelector('.subject-entry');
    subjectEntry.dataset.subjectIndex = subjectCount;
    
    // Update all name attributes with correct index
    clone.querySelectorAll('[name^="subjects[]"]').forEach(input => {
        input.name = input.name.replace('subjects[]', `subjects[${subjectCount}]`);
    });
    
    // Setup day-time interactions
    setupDayTimeInteractions(clone);
    
    container.appendChild(clone);
    subjectCount++;
}

function removeSubject(button) {
    const subjectEntry = button.closest('.subject-entry');
    if (document.querySelectorAll('.subject-entry').length > 1) {
        subjectEntry.remove();
    } else {
        alert('You must have at least one subject for enrollment.');
    }
}

function updateSubjectTitle(selectElement) {
    const subjectEntry = selectElement.closest('.subject-entry');
    const titleSpan = subjectEntry.querySelector('.subject-name');
    titleSpan.textContent = selectElement.value || 'New Subject';
}

function filterTutors(element) {
    const subjectEntry = element.closest('.subject-entry');
    const selectedSubject = subjectEntry.querySelector('.subject-select').value.toLowerCase();
    const selectedGrade = subjectEntry.querySelector('.grade-select').value.toLowerCase();
    const tutorCards = subjectEntry.querySelectorAll('.tutor-card');
    const noTutorsMessage = subjectEntry.querySelector('.no-tutors-message');
    
    let visibleCount = 0;
    
    tutorCards.forEach(card => {
        const tutorSubjects = card.dataset.tutorSubjects;
        const tutorGrades = card.dataset.tutorGrades;
        
        let subjectMatch = !selectedSubject || tutorSubjects.includes(selectedSubject);
        let gradeMatch = !selectedGrade || tutorGrades.includes(selectedGrade);
        
        if (subjectMatch && gradeMatch) {
            card.style.display = 'block';
            visibleCount++;
        } else {
            card.style.display = 'none';
        }
    });
    
    // Show/hide no tutors message
    if (visibleCount === 0) {
        noTutorsMessage.style.display = 'block';
    } else {
        noTutorsMessage.style.display = 'none';
    }
}

function searchTutors(searchInput) {
    const subjectEntry = searchInput.closest('.subject-entry');
    const searchTerm = searchInput.value.toLowerCase();
    const tutorCards = subjectEntry.querySelectorAll('.tutor-card');
    const noTutorsMessage = subjectEntry.querySelector('.no-tutors-message');
    
    let visibleCount = 0;
    
    tutorCards.forEach(card => {
        const tutorName = card.dataset.tutorName;
        const tutorSubjects = card.dataset.tutorSubjects;
        
        if (tutorName.includes(searchTerm) || tutorSubjects.includes(searchTerm)) {
            card.style.display = 'block';
            visibleCount++;
        } else {
            card.style.display = 'none';
        }
    });
    
    if (visibleCount === 0) {
        noTutorsMessage.style.display = 'block';
    } else {
        noTutorsMessage.style.display = 'none';
    }
}

function selectTutor(tutorCard) {
    const subjectEntry = tutorCard.closest('.subject-entry');
    const hiddenInput = subjectEntry.querySelector('.selected-tutor-input');
    const allCards = subjectEntry.querySelectorAll('.tutor-card');
    
    // Remove selection from other cards
    allCards.forEach(card => card.classList.remove('selected'));
    
    // Select this card
    tutorCard.classList.add('selected');
    hiddenInput.value = tutorCard.dataset.tutorId;
}

function clearFilters(button) {
    const subjectEntry = button.closest('.subject-entry');
    const filterSelects = subjectEntry.querySelectorAll('.filter-select');
    const searchInput = subjectEntry.querySelector('.tutor-search');
    
    filterSelects.forEach(select => select.value = '');
    searchInput.value = '';
    
    // Show all tutors
    const tutorCards = subjectEntry.querySelectorAll('.tutor-card');
    tutorCards.forEach(card => card.style.display = 'block');
    
    subjectEntry.querySelector('.no-tutors-message').style.display = 'none';
}

function setupDayTimeInteractions(container) {
    const dayCheckboxes = container.querySelectorAll('[name$="schedule_days"]');
    
    dayCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            const day = this.value;
            const timeSelect = container.querySelector(`[name$="schedule_times_${day}"]`);
            
            if (this.checked) {
                timeSelect.disabled = false;
                timeSelect.required = true;
            } else {
                timeSelect.disabled = true;
                timeSelect.required = false;
                timeSelect.value = '';
            }
        });
    });
}

// Form validation
document.getElementById('enrollmentForm').addEventListener('submit', function(e) {
    const subjects = document.querySelectorAll('.subject-entry');
    let valid = true;
    
    if (subjects.length === 0) {
        e.preventDefault();
        alert('Please add at least one subject.');
        return;
    }
    
    subjects.forEach((subject, index) => {
        const subjectName = subject.querySelector('.subject-select').value;
        const tutorId = subject.querySelector('.selected-tutor-input').value;
        
        if (!subjectName) {
            e.preventDefault();
            alert(`Please select a subject for entry ${index + 1}.`);
            valid = false;
            return;
        }
        
        if (!tutorId) {
            e.preventDefault();
            alert(`Please select a tutor for ${subjectName}.`);
            valid = false;
            return;
        }
    });
});
</script>

<style>
/* Enhanced Enrollment Styles */
.enrollment-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.student-info-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    padding: 25px;
    margin-bottom: 30px;
    display: flex;
    align-items: center;
    gap: 20px;
}

.student-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.student-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

.student-avatar i {
    font-size: 32px;
    color: #6c757d;
}

/* Card Styles */
.card {
    background: white;
    border: none;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    margin-bottom: 25px;
}

.card-header {
    background: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    padding: 20px;
    border-radius: 12px 12px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-title {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #495057;
}

.card-title i {
    color: #F1A150;
    margin-right: 8px;
}

/* Subject Entry */
.subject-entry {
    background: #f8f9fa;
    border: 2px solid #e9ecef;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    position: relative;
}

.subject-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 2px solid #e9ecef;
}

/* Tutor Search Section */
.tutor-search-section {
    margin: 20px 0;
}

.search-filters-row {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    align-items: center;
    flex-wrap: wrap;
}

.search-input-container {
    position: relative;
    flex: 1;
    min-width: 250px;
}

.search-input-container .search-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #6c757d;
}

.filter-buttons {
    display: flex;
    gap: 8px;
    align-items: center;
}

.filter-select {
    min-width: 140px;
}

/* Tutors Grid */
.tutors-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
    max-height: 400px;
    overflow-y: auto;
    padding: 8px;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    background: white;
}

.tutor-card {
    border: 2px solid #e9ecef;
    border-radius: 8px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.2s;
    background: white;
}

.tutor-card:hover {
    border-color: #F1A150;
    box-shadow: 0 2px 8px rgba(241, 161, 80, 0.2);
}

.tutor-card.selected {
    border-color: #F1A150;
    background: rgba(241, 161, 80, 0.1);
}

.tutor-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
    position: relative;
}

.tutor-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.tutor-avatar img {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    object-fit: cover;
}

.tutor-avatar i {
    font-size: 18px;
    color: #F1A150;
}

.tutor-info {
    flex: 1;
}

.tutor-info h5 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 600;
    color: #333;
}

.tutor-info .qualification {
    margin: 0;
    font-size: 12px;
    color: #666;
}

.selection-indicator {
    position: absolute;
    top: -8px;
    right: -8px;
    background: #F1A150;
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

.tutor-card.selected .selection-indicator {
    display: flex;
}

.tutor-details {
    margin-bottom: 12px;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 4px;
    font-size: 12px;
}

.detail-row .label {
    color: #666;
    font-weight: 500;
}

.detail-row .value {
    color: #333;
}

.rating .fa-star {
    color: #ddd;
    font-size: 12px;
}

.rating .fa-star.active {
    color: #ffc107;
}

.specialization-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
}

.subject-tag {
    background: #f8f9fa;
    color: #666;
    padding: 2px 6px;
    border-radius: 8px;
    font-size: 10px;
    border: 1px solid #e9ecef;
}

.subject-tag.more {
    background: #F1A150;
    color: white;
    border-color: #F1A150;
}

/* Schedule Selection */
.schedule-selection {
    margin-top: 20px;
    padding: 16px;
    background: white;
    border-radius: 8px;
    border: 1px solid #e9ecef;
}

.days-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
}

.day-time-slot {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.day-checkbox {
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    padding: 8px;
    background: #f8f9fa;
    border-radius: 6px;
    transition: background-color 0.2s;
}

.day-checkbox:hover {
    background: #e9ecef;
}

.day-checkbox input[type="checkbox"] {
    margin: 0;
}

.day-checkbox input[type="checkbox"]:checked + .day-name {
    font-weight: 600;
    color: #F1A150;
}

.day-name {
    font-size: 14px;
    color: #666;
}

.time-select {
    font-size: 12px;
    padding: 6px;
}

.time-select:disabled {
    background: #f8f9fa;
    border-color: #e9ecef;
}

/* Form Elements */
.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #495057;
}

.form-label.required::after {
    content: ' *';
    color: #dc3545;
}

.form-control {
    width: 100%;
    padding: 12px;
    border: 1px solid #ced4da;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.form-control:focus {
    border-color: #F1A150;
    outline: 0;
    box-shadow: 0 0 0 0.2rem rgba(241, 161, 80, 0.25);
}

/* Buttons */
.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
}

.btn-primary {
    background: #F1A150;
    color: white;
}

.btn-primary:hover {
    background: #C86706;
    transform: translateY(-1px);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #5a6268;
}

.btn-outline-secondary {
    background: transparent;
    color: #6c757d;
    border: 1px solid #6c757d;
}

.btn-outline-secondary:hover {
    background: #6c757d;
    color: white;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 12px;
}

.btn-lg {
    padding: 14px 28px;
    font-size: 16px;
}

.btn-danger {
    background: #dc3545;
    color: white;
}

.btn-danger:hover {
    background: #c82333;
}

/* Form Actions */
.form-actions {
    display: flex;
    gap: 16px;
    justify-content: center;
    padding: 30px 20px;
    background: #f8f9fa;
    border-radius: 0 0 12px 12px;
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 60px 20px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.empty-state i {
    font-size: 64px;
    color: #ddd;
    margin-bottom: 20px;
}

.empty-state h3 {
    color: #666;
    margin-bottom: 10px;
}

.empty-state p {
    color: #999;
    margin-bottom: 20px;
}

/* Responsive Design */
@media (max-width: 768px) {
    .enrollment-container {
        padding: 15px;
    }
    
    .student-info-card {
        flex-direction: column;
        text-align: center;
    }
    
    .search-filters-row {
        flex-direction: column;
        align-items: stretch;
    }
    
    .filter-buttons {
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .tutors-grid {
        grid-template-columns: 1fr;
        max-height: 300px;
    }
    
    .days-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
}

/* Loading and Animation */
.tutor-card {
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Custom scrollbar for tutors grid */
.tutors-grid::-webkit-scrollbar {
    width: 6px;
}

.tutors-grid::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 3px;
}

.tutors-grid::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 3px;
}

.tutors-grid::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8;
}

/* Validation styles */
.form-control.is-invalid {
    border-color: #dc3545;
}

.form-control.is-valid {
    border-color: #28a745;
}

.invalid-feedback {
    display: block;
    width: 100%;
    margin-top: 0.25rem;
    font-size: 0.875em;
    color: #dc3545;
}

.valid-feedback {
    display: block;
    width: 100%;
    margin-top: 0.25rem;
    font-size: 0.875em;
    color: #28a745;
}
</style>
{% endblock %}