{% extends "base.html" %}

{% block title %}My Classes - LMS{% endblock %}

{% block content %}
<div class="page-header">
    <div class="header-content">
        <h1 class="page-title">
            <i class="fas fa-chalkboard"></i>
            My Classes
        </h1>
        <div class="header-actions">
            <button class="btn btn-primary" onclick="window.location.reload()">
                <i class="fas fa-sync"></i>
                Refresh
            </button>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div class="stats-container">
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon bg-primary">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats.total_classes or 0 }}</div>
                <div class="stat-label">Total Classes</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon bg-success">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats.completed_classes or 0 }}</div>
                <div class="stat-label">Completed</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon bg-info">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ stats.upcoming_classes or 0 }}</div>
                <div class="stat-label">Upcoming</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon bg-warning">
                <i class="fas fa-percentage"></i>
            </div>
            <div class="stat-content">
                <div class="stat-value">{{ "%.1f"|format(stats.completion_rate or 0) }}%</div>
                <div class="stat-label">Completion Rate</div>
            </div>
        </div>
    </div>
</div>

<!-- Classes List -->
<div class="classes-container">
    {% if classes %}
    <div class="classes-list">
        {% for class in classes %}
        <div class="class-card">
            <div class="class-header">
                <h3 class="class-title">{{ class.subject }}</h3>
                <span class="class-status status-{{ class.status }}">
                    {{ class.status|title }}
                </span>
            </div>
            
            <div class="class-details">
                <div class="detail-item">
                    <i class="fas fa-calendar"></i>
                    <span>{{ class.class_date.strftime('%B %d, %Y') if class.class_date else 'Not scheduled' }}</span>
                </div>
                <div class="detail-item">
                    <i class="fas fa-clock"></i>
                    <span>{{ class.start_time.strftime('%I:%M %p') if class.start_time else '' }} - {{ class.end_time.strftime('%I:%M %p') if class.end_time else '' }}</span>
                </div>
                {% if class.enrollment and class.enrollment.student %}
                <div class="detail-item">
                    <i class="fas fa-user-graduate"></i>
                    <span>{{ class.enrollment.student.full_name }}</span>
                </div>
                {% endif %}
            </div>
            
            <div class="class-actions">
                <a href="{{ url_for('view_class', id=class.id) }}" class="btn btn-sm btn-primary">
                    <i class="fas fa-eye"></i>
                    View Details
                </a>
                {% if class.status == 'scheduled' %}
                <button class="btn btn-sm btn-success" onclick="startClass('{{ class.id }}')">
                    <i class="fas fa-play"></i>
                    Start Class
                </button>
                {% elif class.status == 'in_progress' %}
                <button class="btn btn-sm btn-warning" onclick="endClass('{{ class.id }}')">
                    <i class="fas fa-stop"></i>
                    End Class
                </button>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-chalkboard"></i>
        <h3>No Classes Found</h3>
        <p>You don't have any classes assigned yet.</p>
    </div>
    {% endif %}
</div>

<style>
.stats-container {
    padding: 20px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.stat-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    gap: 16px;
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
}

.stat-icon.bg-primary { background: #F1A150; }
.stat-icon.bg-success { background: #28A745; }
.stat-icon.bg-info { background: #17A2B8; }
.stat-icon.bg-warning { background: #FFC107; }

.stat-content {
    flex: 1;
}

.stat-value {
    font-size: 28px;
    font-weight: 700;
    color: #212529;
}

.stat-label {
    color: #6C757D;
    font-size: 14px;
}

.classes-container {
    padding: 20px;
}

.classes-list {
    display: grid;
    gap: 20px;
}

.class-card {
    background: white;
    border-radius: 12px;
    padding: 24px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    border: 1px solid #f0f0f0;
}

.class-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.class-title {
    font-size: 20px;
    font-weight: 600;
    color: #212529;
    margin: 0;
}

.class-status {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
}

.status-scheduled { background: #E3F2FD; color: #1976D2; }
.status-in_progress { background: #FFF3E0; color: #F57C00; }
.status-completed { background: #E8F5E9; color: #388E3C; }
.status-cancelled { background: #FFEBEE; color: #D32F2F; }

.class-details {
    display: grid;
    gap: 12px;
    margin-bottom: 20px;
}

.detail-item {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #6C757D;
    font-size: 14px;
}

.detail-item i {
    width: 20px;
    color: #F1A150;
}

.class-actions {
    display: flex;
    gap: 10px;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #6C757D;
}

.empty-state i {
    font-size: 64px;
    color: #E9ECEF;
    margin-bottom: 20px;
}
</style>

<script>
function startClass(classId) {
    if (confirm('Are you ready to start this class?')) {
        window.location.href = `/classes/${classId}/start`;
    }
}

function endClass(classId) {
    if (confirm('Are you sure you want to end this class?')) {
        window.location.href = `/classes/${classId}/end`;
    }
}
</script>
{% endblock %}